<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Telegram Webhook Integration</title>
<style>
:root {
--background: 0 0% 100%;
--foreground: 222.2 84% 4.9%;
--card: 0 0% 100%;
--card-foreground: 222.2 84% 4.9%;
--popover: 0 0% 100%;
--popover-foreground: 222.2 84% 4.9%;
--primary: 221.2 83.2% 53.3%;
--primary-foreground: 210 40% 98%;
--secondary: 210 40% 96%;
--secondary-foreground: 222.2 84% 4.9%;
--muted: 210 40% 96%;
--muted-foreground: 215.4 16.3% 46.9%;
--accent: 210 40% 96%;
--accent-foreground: 222.2 84% 4.9%;
--destructive: 0 84.2% 60.2%;
--destructive-foreground: 210 40% 98%;
--border: 214.3 31.8% 91.4%;
--input: 214.3 31.8% 91.4%;
--ring: 221.2 83.2% 53.3%;
--radius: 0.5rem;
--shadow: 222.2 84% 4.9%;
--success: 120 99% 38%;
--warning: 45 100% 50%;
--info: 210 100% 50%;
}
:root.dark-theme {
--background: 222.2 84% 4.9%;
--foreground: 210 40% 98%;
--card: 216 12% 17%;
--card-foreground: 210 40% 98%;
--popover: 216 12% 17%;
--popover-foreground: 210 40% 98%;
--primary: 221.2 83.2% 53.3%;
--primary-foreground: 210 40% 98%;
--secondary: 216 10% 25%;
--secondary-foreground: 210 40% 98%;
--muted: 216 10% 25%;
--muted-foreground: 215.4 16.3% 66.9%;
--accent: 216 10% 25%;
--accent-foreground: 210 40% 98%;
--destructive: 0 84.2% 60.2%;
--destructive-foreground: 210 40% 98%;
--border: 216 10% 30%;
--input: 216 10% 30%;
--ring: 221.2 83.2% 53.3%;
--shadow: 222.2 84% 4.9%;
--success: 120 99% 38%;
--warning: 45 100% 50%;
--info: 210 100% 50%;
}
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}
body {
background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--accent)));
color: hsl(var(--foreground));
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
min-height: 100vh;
padding: 1rem;
transition: background-color 0.3s ease;
}
.login-container {
display: flex;
justify-content: center;
align-items: center;
min-height: 100vh;
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--accent)));
z-index: 9999;
transition: background 0.3s ease;
}
.login-container.hidden {
display: none;
}
.login-card {
background: hsl(var(--card));
border: 1px solid hsl(var(--border));
border-radius: var(--radius);
padding: 2rem;
box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
width: 100%;
max-width: 400px;
transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.login-card:hover {
transform: translateY(-2px);
box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}
.login-card h1 {
color: hsl(var(--foreground));
margin-bottom: 1rem;
text-align: center;
font-size: 1.5rem;
font-weight: 600;
display: flex;
align-items: center;
justify-content: center;
gap: 0.5rem;
}
.login-card p {
color: hsl(var(--muted-foreground));
text-align: center;
margin-bottom: 2rem;
font-size: 0.875rem;
}
.login-form-group {
margin-bottom: 1.5rem;
}
.login-form-group label {
display: block;
margin-bottom: 0.5rem;
color: hsl(var(--foreground));
font-weight: 500;
font-size: 0.875rem;
}
.login-form-group input {
width: 100%;
padding: 0.75rem;
border: 1px solid hsl(var(--input));
border-radius: var(--radius);
font-size: 1rem;
background: hsl(var(--background));
color: hsl(var(--foreground));
transition: border-color 0.2s ease, box-shadow 0.2s ease;
}
.login-form-group input:focus {
outline: none;
border-color: hsl(var(--ring));
box-shadow: 0 0 0 2px hsl(var(--ring) / 0.2);
}
.login-btn {
width: 100%;
padding: 0.75rem;
background: hsl(var(--primary));
color: hsl(var(--primary-foreground));
border: none;
border-radius: var(--radius);
font-size: 1rem;
font-weight: 600;
cursor: pointer;
transition: all 0.2s;
}
.login-btn:hover {
background: hsl(var(--primary) / 0.9);
}
.login-alert {
display: none;
padding: 0.75rem;
background: hsl(var(--destructive) / 0.1);
color: hsl(var(--destructive));
border: 1px solid hsl(var(--destructive) / 0.2);
border-radius: var(--radius);
margin-bottom: 1rem;
font-size: 0.875rem;
}
.login-alert.show {
display: block;
animation: fadeIn 0.3s ease;
}
.container {
max-width: 1200px;
margin: 0 auto;
}
header {
text-align: center;
color: hsl(var(--foreground));
margin-bottom: 2rem;
display: flex;
justify-content: space-between;
align-items: center;
position: relative;
}
header h1 {
font-size: 2.5rem;
margin: 0;
flex: 1;
display: flex;
align-items: center;
justify-content: center;
gap: 0.75rem;
}
.header-actions {
display: flex;
gap: 0.75rem;
align-items: center;
}
.theme-toggle {
position: relative;
z-index: 10;
}
.icon-btn {
background: hsl(var(--secondary));
border: 1px solid hsl(var(--border));
border-radius: 50%;
width: 2.5rem;
height: 2.5rem;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
color: hsl(var(--secondary-foreground));
transition: all 0.2s;
}
.icon-btn:hover {
background: hsl(var(--accent));
}
.logout-btn {
background: hsl(var(--secondary));
color: hsl(var(--secondary-foreground));
border: 1px solid hsl(var(--border));
padding: 0.5rem 1rem;
border-radius: var(--radius);
cursor: pointer;
transition: all 0.2s;
font-size: 0.875rem;
display: flex;
align-items: center;
gap: 0.5rem;
}
.logout-btn:hover {
background: hsl(var(--accent));
}
.content {
display: grid;
grid-template-columns: 1fr;
gap: 2rem;
margin-bottom: 2rem;
}
.card {
background: hsl(var(--card));
border: 1px solid hsl(var(--border));
border-radius: var(--radius);
box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
transition: transform 0.3s ease;
overflow: hidden;
}
.card:hover {
transform: translateY(-2px);
}
.card-header {
padding: 1.5rem;
border-bottom: 2px solid hsl(var(--primary));
display: flex;
justify-content: space-between;
align-items: center;
cursor: pointer;
}
.card-header h2 {
color: hsl(var(--foreground));
margin: 0;
font-size: 1.25rem;
font-weight: 600;
display: flex;
align-items: center;
gap: 0.5rem;
}
.card-header-icon {
transition: transform 0.3s ease;
}
.card-header.collapsed .card-header-icon {
transform: rotate(-90deg);
}
.card-content {
padding: 0 2rem;
max-height: 1000px;
overflow: hidden;
transition: max-height 0.3s ease, padding 0.3s ease;
}
.card-content.collapsed {
max-height: 0;
padding: 0;
}
.form-group {
margin-bottom: 1.5rem;
}
label {
display: block;
margin-bottom: 0.5rem;
color: hsl(var(--foreground));
font-weight: 500;
font-size: 0.875rem;
}
.form-hint {
color: hsl(var(--muted-foreground));
font-size: 0.8125rem;
margin-top: 0.3125rem;
display: block;
}
input[type="text"],
input[type="number"],
input[type="password"],
textarea,
select {
width: 100%;
padding: 0.75rem;
border: 1px solid hsl(var(--input));
border-radius: var(--radius);
font-size: 1rem;
background: hsl(var(--background));
color: hsl(var(--foreground));
transition: border-color 0.2s ease, box-shadow 0.2s ease;
}
input[type="text"]:focus,
input[type="number"]:focus,
input[type="password"]:focus,
textarea:focus,
select:focus {
outline: none;
border-color: hsl(var(--ring));
box-shadow: 0 0 0 2px hsl(var(--ring) / 0.2);
}
textarea {
resize: vertical;
min-height: 6rem;
font-family: 'Courier New', monospace;
}
.checkbox-group {
display: flex;
align-items: center;
gap: 0.5rem;
}
input[type="checkbox"] {
width: 1rem;
height: 1rem;
cursor: pointer;
}
.button-group {
display: flex;
gap: 0.75rem;
margin-top: 1.5rem;
flex-wrap: wrap;
}
button {
flex: 1;
min-width: 120px;
padding: 0.75rem;
border: none;
border-radius: var(--radius);
font-size: 1rem;
cursor: pointer;
font-weight: 600;
transition: all 0.2s;
}
.btn-primary {
background: hsl(var(--primary));
color: hsl(var(--primary-foreground));
}
.btn-primary:hover {
background: hsl(var(--primary) / 0.9);
}
.btn-secondary {
background: hsl(var(--secondary));
color: hsl(var(--secondary-foreground));
}
.btn-secondary:hover {
background: hsl(var(--accent));
}
.btn-danger {
background: hsl(var(--destructive));
color: hsl(var(--destructive-foreground));
}
.btn-danger:hover {
background: hsl(var(--destructive) / 0.9);
}
.btn-test {
background: hsl(var(--primary));
color: hsl(var(--primary-foreground));
}
.btn-test:hover {
background: hsl(var(--primary) / 0.9);
}
.btn-outline {
background: transparent;
border: 1px solid hsl(var(--border));
}
.btn-small {
padding: 0.5rem 0.75rem;
font-size: 0.875rem;
min-width: auto;
}
.btn-success {
background: hsl(var(--success));
color: white;
}
.btn-warning {
background: hsl(var(--warning));
color: white;
}
.btn-info {
background: hsl(var(--info));
color: white;
}
.rules-list {
max-height: 37.5rem;
overflow-y: auto;
padding: 0.5rem;
}
.rule-item {
background: hsl(var(--muted));
border-left: 4px solid hsl(var(--primary));
padding: 1rem;
margin-bottom: 1rem;
border-radius: var(--radius);
display: flex;
justify-content: space-between;
align-items: flex-start;
gap: 1rem;
transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.rule-item:hover {
transform: translateX(5px);
box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}
.rule-item.disabled {
opacity: 0.6;
border-left-color: hsl(var(--muted-foreground));
}
.rule-item.disabled:hover {
transform: none;
box-shadow: none;
}
.rule-content {
flex: 1;
}
.rule-name {
font-weight: 600;
color: hsl(var(--foreground));
margin-bottom: 0.5rem;
display: flex;
align-items: center;
gap: 0.5rem;
}
.rule-condition {
background: hsl(var(--background));
padding: 0.625rem;
border-radius: calc(var(--radius) - 2px);
font-family: 'Courier New', monospace;
font-size: 0.875rem;
color: hsl(var(--muted-foreground));
margin-bottom: 0.5rem;
word-break: break-word;
border: 1px solid hsl(var(--border));
}
.rule-channel {
color: hsl(var(--muted-foreground));
font-size: 0.875rem;
}
.rule-bot {
color: hsl(var(--muted-foreground));
font-size: 0.875rem;
margin-top: 0.25rem;
}
.rule-actions {
display: flex;
flex-direction: column;
gap: 8px;
min-width: 120px;
}
.rule-status {
display: flex;
gap: 5px;
align-items: center;
font-size: 0.85em;
margin-top: 0.5rem;
}
.status-badge {
display: inline-block;
width: 10px;
height: 10px;
border-radius: 50%;
background: #27ae60;
}
.status-badge.disabled {
background: #999;
}
.alert {
padding: 1rem;
border-radius: calc(var(--radius) - 2px);
margin-bottom: 1rem;
display: none;
border: 1px solid hsl(var(--border));
animation: fadeIn 0.3s ease;
}
.alert.show {
display: block;
}
.alert-success {
background: hsl(var(--success) / 0.15);
color: hsl(var(--success));
border-color: hsl(var(--success) / 0.3);
}
.alert-error {
background: hsl(var(--destructive) / 0.1);
color: hsl(var(--destructive));
border-color: hsl(var(--destructive) / 0.3);
}
.alert-info {
background: hsl(var(--info) / 0.1);
color: hsl(var(--info));
border-color: hsl(var(--info) / 0.3);
}
.alert-warning {
background: hsl(var(--warning) / 0.1);
color: hsl(var(--warning));
border-color: hsl(var(--warning) / 0.3);
}
.instructions {
background: hsl(var(--muted));
border-radius: var(--radius);
padding: 1.5rem;
box-shadow: hsl(var(--shadow) / 0.1) 0px 4px 6px -1px, hsl(var(--shadow) / 0.1) 0px 2px 4px -2px;
color: hsl(var(--foreground));
margin-top: 1rem;
}
.instructions h3 {
color: hsl(var(--primary));
margin-top: 1.25rem;
margin-bottom: 0.5rem;
display: flex;
align-items: center;
gap: 0.5rem;
}
.instructions h3:first-child {
margin-top: 0;
}
.instructions code {
background: #f5f5f5;
padding: 2px 6px;
border-radius: 3px;
font-family: 'Courier New', monospace;
color: #d32f2f;
}
.dark-theme .instructions code {
background: #444;
color: #ff7070;
}
.instructions pre {
background: #2d2d2d;
color: #f8f8f2;
padding: 15px;
border-radius: 5px;
overflow-x: auto;
font-family: 'Courier New', monospace;
margin: 10px 0;
}
.dark-theme .instructions pre {
background: #1e1e1e;
color: #d4d4d4;
}
.instructions ul,
.instructions ol {
margin-left: 20px;
margin-bottom: 15px;
}
.instructions li {
margin-bottom: 8px;
line-height: 1.6;
}
.webhook-url {
background: #f5f5f5;
padding: 10px;
border-radius: 5px;
word-break: break-all;
font-family: 'Courier New', monospace;
margin-top: 10px;
border: 1px solid #ddd;
}
.dark-theme .webhook-url {
background: #333;
border-color: #555;
color: #fff;
}
.test-section {
margin-top: 20px;
padding-top: 20px;
border-top: 1px solid hsl(var(--border));
}
.test-result {
background: #f5f5f5;
padding: 10px;
border-radius: 5px;
margin-top: 10px;
font-family: 'Courier New', monospace;
display: none;
border-left: 4px solid #6c757d;
}
.dark-theme .test-result {
background: #333;
color: #fff;
}
.test-result.success {
border-left-color: hsl(var(--success));
}
.test-result.error {
border-left-color: hsl(var(--destructive));
}
.loading {
display: inline-block;
width: 20px;
height: 20px;
border: 3px solid #f3f3f3;
border-top: 3px solid #667eea;
border-radius: 50%;
animation: spin 1s linear infinite;
}
@keyframes spin {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}
@keyframes fadeIn {
from { opacity: 0; transform: translateY(-10px); }
to { opacity: 1; transform: translateY(0); }
}
/* Modal styles */
.modal {
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0.5);
display: flex;
align-items: center;
justify-content: center;
z-index: 1000;
}
.modal-content {
background: hsl(var(--card));
border-radius: var(--radius);
padding: 0;
max-width: 500px;
width: 90%;
max-height: 90vh;
overflow-y: auto;
box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
}
.modal-header {
display: flex;
align-items: center;
padding: 1.5rem;
border-bottom: 1px solid hsl(var(--border));
}
.modal-header h2 {
margin: 0;
}
.modal-body {
padding: 1.5rem;
}
/* Tabs styles */
.tabs-container {
margin-bottom: 2rem;
}
.tabs {
display: flex;
gap: 0.25rem;
border-bottom: 2px solid hsl(var(--border));
margin-bottom: 1.5rem;
overflow-x: auto;
padding-bottom: 0.5rem;
flex-wrap: wrap;
}
.tab {
padding: 0.75rem 1.5rem;
background: hsl(var(--secondary));
border: none;
border-radius: var(--radius) var(--radius) 0 0;
cursor: pointer;
font-weight: 500;
transition: all 0.2s;
white-space: nowrap;
display: flex;
align-items: center;
gap: 0.5rem;
}
.tab:hover {
background: hsl(var(--accent));
}
.tab.active {
background: hsl(var(--card));
border-bottom: 2px solid hsl(var(--primary));
font-weight: 600;
}
.tab-content {
position: relative;
}
.tab-pane {
display: none;
}
.tab-pane.active {
display: block;
animation: fadeIn 0.3s ease;
}
/* Rules toolbar styles */
.rules-toolbar {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 1rem;
flex-wrap: wrap;
gap: 1rem;
padding: 0 1rem;
}
.rules-toolbar h2 {
margin-bottom: 0;
border: none;
padding: 0;
}
.rules-search {
position: relative;
width: 250px;
}
.rules-search input {
padding-left: 2.5rem;
}
.rules-search::before {
content: "üîç";
position: absolute;
left: 0.75rem;
top: 50%;
transform: translateY(-50%);
color: hsl(var(--muted-foreground));
font-size: 1rem;
}
/* Create rule button */
.create-rule-btn {
background: hsl(var(--primary));
color: hsl(var(--primary-foreground));
border: none;
padding: 0.75rem 1.5rem;
border-radius: var(--radius);
font-weight: 600;
cursor: pointer;
display: flex;
align-items: center;
gap: 0.5rem;
transition: all 0.2s;
margin-bottom: 1.5rem;
box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}
.create-rule-btn:hover {
background: hsl(var(--primary) / 0.9);
transform: translateY(-1px);
}
/* Logs styles */
.logs-toolbar {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 1.5rem;
flex-wrap: wrap;
gap: 1rem;
}
.logs-toolbar h2 {
margin-bottom: 0;
border: none;
padding: 0;
}
.logs-actions {
display: flex;
gap: 0.75rem;
}
.logs-container {
max-height: 40rem;
overflow-y: auto;
padding: 0.5rem;
}
.log-item {
border-bottom: 1px solid hsl(var(--border));
padding: 0.625rem 0;
color: hsl(var(--foreground));
}
.log-timestamp {
font-weight: 600;
color: hsl(var(--foreground));
margin-bottom: 0.25rem;
}
.log-payload {
background: hsl(var(--background));
color: hsl(var(--foreground));
padding: 0.5rem;
margin: 0.3125rem 0;
font-size: 0.875rem;
border-radius: calc(var(--radius) - 2px);
border: 1px solid hsl(var(--border));
max-height: 15rem;
overflow: auto;
}
.log-match {
margin-top: 0.3125rem;
font-weight: 500;
}
.log-telegram {
margin-top: 0.3125rem;
}
.log-telegram-item {
margin: 0.25rem 0;
padding-left: 1.25rem;
}
.log-success {
color: hsl(var(--success));
}
.log-error {
color: hsl(var(--destructive));
}
/* Pagination */
.pagination {
display: flex;
justify-content: center;
align-items: center;
gap: 1rem;
margin-top: 1.5rem;
padding-top: 1rem;
border-top: 1px solid hsl(var(--border));
}
.page-btn {
background: hsl(var(--secondary));
border: 1px solid hsl(var(--border));
padding: 0.5rem 1rem;
border-radius: var(--radius);
cursor: pointer;
transition: all 0.2s;
}
.page-btn:hover:not(:disabled) {
background: hsl(var(--accent));
}
.page-btn:disabled {
opacity: 0.5;
cursor: not-allowed;
}
.page-info {
color: hsl(var(--muted-foreground));
font-size: 0.875rem;
}
/* Condition builder */
.condition-builder {
background: hsl(var(--muted));
border-radius: var(--radius);
padding: 1.5rem;
margin-top: 1rem;
}
.condition-mode-toggle {
display: flex;
gap: 1rem;
margin-bottom: 1.5rem;
flex-wrap: wrap;
}
.condition-mode-toggle label {
display: flex;
align-items: center;
gap: 0.5rem;
cursor: pointer;
}
.condition-groups {
margin-bottom: 1.5rem;
}
.condition-group {
background: hsl(var(--background));
border: 1px solid hsl(var(--border));
border-radius: var(--radius);
padding: 1.25rem;
margin-bottom: 1rem;
}
.condition-rows {
margin-bottom: 1rem;
display: flex;
flex-direction: column;
gap: 0.75rem;
}
.condition-row {
display: flex;
gap: 0.75rem;
align-items: center;
flex-wrap: wrap;
}
.condition-row select,
.condition-row input {
flex: 1;
min-width: 150px;
}
.add-condition-btn {
background: hsl(var(--secondary));
border: 1px solid hsl(var(--border));
padding: 0.375rem 0.75rem;
border-radius: var(--radius);
cursor: pointer;
font-size: 0.875rem;
transition: all 0.2s;
display: inline-flex;
align-items: center;
gap: 0.5rem;
}
.add-condition-btn:hover {
background: hsl(var(--accent));
}
.remove-condition-btn {
background: hsl(var(--destructive));
color: white;
border: none;
border-radius: 50%;
width: 24px;
height: 24px;
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
font-size: 0.875rem;
padding: 0;
}
.condition-logic {
margin-top: 1rem;
padding-top: 1rem;
border-top: 1px solid hsl(var(--border));
}
.preview-section {
margin-top: 1.5rem;
padding-top: 1.5rem;
border-top: 2px solid hsl(var(--primary));
}
.preview-result {
background: hsl(var(--background));
border-radius: calc(var(--radius) - 2px);
padding: 1rem;
margin-bottom: 1.5rem;
font-family: 'Courier New', monospace;
font-size: 0.875rem;
border: 1px solid hsl(var(--border));
}
.telegram-preview {
border: 1px solid hsl(var(--border));
border-radius: var(--radius);
overflow: hidden;
background: #eaeaea;
max-width: 400px;
margin: 0 auto;
}
.telegram-message {
display: flex;
padding: 0.75rem;
background: white;
}
.telegram-avatar {
width: 40px;
height: 40px;
background: #0088cc;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
color: white;
font-weight: bold;
margin-right: 0.75rem;
flex-shrink: 0;
}
.telegram-content {
flex: 1;
}
.telegram-sender {
font-weight: 600;
color: #000;
margin-bottom: 0.25rem;
}
.telegram-text {
color: #333;
line-height: 1.5;
font-size: 0.9375rem;
white-space: pre-line;
}
.telegram-time {
color: #999;
font-size: 0.75rem;
margin-top: 0.25rem;
}
.code-condition-editor {
margin-top: 1rem;
}
/* Input with button */
.input-with-button {
position: relative;
display: flex;
gap: 0.5rem;
}
.input-with-button input {
flex: 1;
}
.input-with-button button {
position: absolute;
right: 0.75rem;
top: 50%;
transform: translateY(-50%);
background: transparent;
border: none;
color: hsl(var(--muted-foreground));
cursor: pointer;
padding: 0;
}
/* Export/import section */
.export-import-section {
margin-top: 2rem;
padding-top: 1.5rem;
border-top: 1px solid hsl(var(--border));
}
.export-import-section h3 {
margin-top: 0;
color: hsl(var(--primary));
border: none;
padding: 0;
}
.skeleton {
background: linear-gradient(90deg,
hsl(var(--muted)) 0%,
hsl(var(--muted) / 0.8) 50%,
hsl(var(--muted)) 100%
);
background-size: 200% 100%;
animation: loading 1.5s infinite;
}
@keyframes loading {
0% { background-position: 200% 0; }
100% { background-position: -200% 0; }
}
/* Responsive design */
@media (max-width: 768px) {
.content {
grid-template-columns: 1fr;
}
header {
flex-direction: column;
gap: 15px;
}
header h1 {
font-size: 2em;
}
.tabs {
flex-wrap: wrap;
}
.tab {
padding: 0.5rem 1rem;
font-size: 0.875rem;
}
.rules-toolbar, .logs-toolbar {
flex-direction: column;
align-items: stretch;
}
.rules-search {
width: 100%;
}
.button-group {
flex-direction: column;
}
.btn-small {
width: 100%;
}
.rule-item {
flex-direction: column;
}
.rule-actions {
flex-direction: row;
flex-wrap: wrap;
}
.condition-row {
flex-direction: column;
align-items: stretch;
}
.telegram-preview {
max-width: 100%;
}
.create-rule-btn {
width: 100%;
}
}
</style>
</head>
<body>
<!-- Login Screen -->
<div class="login-container" id="loginContainer">
<div class="login-card">
<h1>üîê –í—Ö–æ–¥</h1>
<p>Telegram Webhook Integration</p>
<div id="loginAlert" class="login-alert"></div>
<form id="loginForm">
<div class="login-form-group">
<label for="username">–õ–æ–≥–∏–Ω</label>
<input type="text" id="username" placeholder="vadmin" required>
</div>
<div class="login-form-group">
<label for="password">–ü–∞—Ä–æ–ª—å</label>
<input type="password" id="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
</div>
<button type="submit" class="login-btn">–í–æ–π—Ç–∏</button>
</form>
</div>
</div>
<!-- Main Application -->
<div class="main-app" id="mainApp" style="display: none;">
<div class="container">
<header>
<h1>üì± Telegram Webhook Integration üí≤VadminLink</h1>
<div class="header-actions">
<span id="currentUsername" style="margin-right: 1rem; color: hsl(var(--muted-foreground));"></span>
<button class="logout-btn" onclick="showChangePasswordModal()" style="margin-right: 0.5rem;">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
<path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
</svg>
–°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å
</button>
<div class="theme-toggle">
<button id="themeToggle" class="icon-btn" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<circle cx="12" cy="12" r="5"></circle>
<line x1="12" y1="1" x2="12" y2="3"></line>
<line x1="12" y1="21" x2="12" y2="23"></line>
<line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
<line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
<line x1="1" y1="12" x2="3" y2="12"></line>
<line x1="21" y1="12" x2="23" y2="12"></line>
<line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
<line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>
</button>
</div>
<button class="logout-btn" onclick="logout()">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
<polyline points="16 17 21 12 16 7"></polyline>
<line x1="21" y1="12" x2="9" y2="12"></line>
</svg>
–í—ã—Ö–æ–¥
</button>
</div>
</header>
<!-- Modal for change password -->
<div id="changePasswordModal" class="modal" style="display: none;">
<div class="modal-content">
<div class="modal-header">
<h2>üîê –°–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</h2>
<button class="icon-btn" onclick="closeChangePasswordModal()" style="margin-left: auto;">‚úï</button>
</div>
<div class="modal-body">
<div id="changePasswordAlert" class="alert"></div>
<form id="changePasswordForm">
<div class="form-group">
<label for="oldPassword">–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å</label>
<input type="password" id="oldPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
</div>
<div class="form-group">
<label for="newPasswordChange">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
<input type="password" id="newPasswordChange" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
</div>
<div class="form-group">
<label for="confirmPassword">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –Ω–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
<input type="password" id="confirmPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
</div>
<div class="button-group">
<button type="submit" class="btn-primary">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
<button type="button" class="btn-secondary" onclick="closeChangePasswordModal()">–û—Ç–º–µ–Ω–∞</button>
</div>
</form>
</div>
</div>
</div>
<div class="tabs-container">
<div class="tabs">
<button class="tab active" data-tab="rules">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
<line x1="9" y1="9" x2="15" y2="15"></line>
<line x1="15" y1="9" x2="9" y2="15"></line>
</svg>
–ü—Ä–∞–≤–∏–ª–∞
</button>
<button class="tab" data-tab="test">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<circle cx="12" cy="12" r="10"></circle>
<line x1="12" y1="8" x2="12" y2="12"></line>
<line x1="12" y1="16" x2="12.01" y2="16"></line>
</svg>
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
</button>
<button class="tab" data-tab="history">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<polyline points="12 6 12 12 16 14"></polyline>
<circle cx="12" cy="12" r="10"></circle>
</svg>
–ò—Å—Ç–æ—Ä–∏—è
</button>
<button class="tab" data-tab="queue">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
<line x1="9" y1="9" x2="15" y2="9"></line>
<line x1="9" y1="15" x2="15" y2="15"></line>
</svg>
–û—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π
</button>
<button class="tab" data-tab="users" id="usersTab" style="display: none;">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
<circle cx="9" cy="7" r="4"></circle>
<path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
<path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
</svg>
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
</button>
</div>
<div class="tab-content">
<div id="rules-tab" class="tab-pane active">
<div class="content">
<div class="card">
<div class="rules-toolbar">
<h2>üìã –ü—Ä–∞–≤–∏–ª–∞</h2>
<div style="display: flex; gap: 0.5rem; align-items: center;">
<div class="rules-search">
<input type="text" id="rulesSearch" placeholder="–ü–æ–∏—Å–∫ –ø—Ä–∞–≤–∏–ª...">
</div>
<button class="btn-secondary btn-small" id="toggleSettingsBtn" onclick="toggleSettingsPanel()" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<circle cx="12" cy="12" r="3"></circle>
<path d="M12 1v6m0 6v6m9-9h-6m-6 0H3m15.364 6.364l-4.243-4.243m-4.242 0L5.636 17.364m12.728 0l-4.243-4.243m-4.242 0L5.636 6.636"></path>
</svg>
</button>
</div>
</div>
<div id="rulesAlert" class="alert"></div>
<div id="settingsPanel" class="card" style="display: none; margin-bottom: 1rem;">
<div class="card-header" id="settingsHeader" onclick="toggleSettingsPanel()" style="cursor: pointer;">
<h3 style="margin: 0; display: flex; align-items: center; gap: 0.5rem;">
<svg class="card-header-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="transform: rotate(-90deg); transition: transform 0.3s;">
<polyline points="6 9 12 15 18 9"></polyline>
</svg>
üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
</h3>
</div>
<div class="card-content collapsed" id="settingsContent" style="max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out;">
<div style="margin-bottom: 2rem;">
<h3>üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</h3>
<ol>
<li>–ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –æ—Ç <code>@BotFather</code> –≤ Telegram</li>
<li>–í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ –ø–æ–ª–µ "–¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞" –∏ —Å–æ–∑–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª–æ</li>
<li>–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É—Å–ª–æ–≤–∏–µ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤–µ–±—Ö—É–∫–æ–≤</li>
</ol>
<h3 style="margin-top: 1.5rem;">üìù –ü—Ä–∏–º–µ—Ä—ã —É—Å–ª–æ–≤–∏–π</h3>
<ul>
<li><code>payload.team_id === 40</code> - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ ID –∫–æ–º–∞–Ω–¥—ã (—á–∏—Å–ª–æ)</li>
<li><code>payload.team.name === "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"</code> - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∫–æ–º–∞–Ω–¥—ã</li>
<li><code>payload.status === "error"</code> - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞</li>
<li><code>payload.impact === "high"</code> - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∏—è–Ω–∏—è</li>
<li><code>payload.subject.includes("—Å–µ—Ä–≤–µ—Ä")</code> - –ø–æ–∏—Å–∫ –≤ —Ç–µ–º–µ</li>
<li><code>payload.note && payload.note.some(n => n.text.includes("—Å—Ä–æ—á–Ω–æ"))</code> - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</li>
<li><code>new Date(payload.created_at) > new Date(Date.now() - 3600000)</code> - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–∑–¥–∞–Ω–∏—è</li>
<li><code>payload.category === "incident" && payload.impact === "high"</code> - –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Å–ª–æ–≤–∏–π</li>
</ul>
<h3 style="margin-top: 1.5rem;">üîó Webhook URL</h3>
<p>–û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ POST –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —ç—Ç–æ—Ç –∞–¥—Ä–µ—Å:</p>
<div class="webhook-url" id="webhookUrlSettings" style="background: hsl(var(--card)); padding: 0.75rem; border-radius: calc(var(--radius) - 2px); border: 1px solid hsl(var(--border)); font-family: monospace; word-break: break-all;">http://localhost:3000/webhook</div>
<button class="btn-secondary btn-small" onclick="copyWebhookUrlFromSettings()" style="margin-top: 0.5rem;">
<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
<path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
</svg>
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
</button>
<h3 style="margin-top: 1.5rem;">üìã –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞</h3>
<pre style="background: hsl(var(--card)); padding: 1rem; border-radius: calc(var(--radius) - 2px); border: 1px solid hsl(var(--border)); overflow-x: auto; font-size: 0.875rem;">curl -X POST http://localhost:3000/webhook \
-H "Content-Type: application/json" \
-d '{
"team_id": 40,
"team": {
"id": 40,
"name": "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"
},
"category": "incident",
"impact": "medium",
"subject": "–ù–æ—É—Ç–±—É–∫ CMP00035 –±–æ–ª—å—à–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è",
"requested_by": {
"name": "–ú–æ–∫–æ—Å–µ–µ–≤–∞ –ö—Å–µ–Ω–∏—è",
"account": {
"name": "–ê–û –ü—Ä–æ–ü—Ä–æ–¥—É–∫—Ç"
}
}
}'</pre>
</div>
<div style="border-top: 1px solid hsl(var(--border)); padding-top: 1.5rem; margin-top: 1.5rem;">
<h3>üíæ –≠–∫—Å–ø–æ—Ä—Ç/–ò–º–ø–æ—Ä—Ç –ø—Ä–∞–≤–∏–ª</h3>
<div class="button-group">
<button class="btn-secondary" onclick="exportRules()">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞</button>
<button class="btn-secondary" onclick="document.getElementById('importFile').click()">–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞</button>
<input type="file" id="importFile" accept=".json" style="display: none;">
</div>
<small class="form-hint">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –ø–µ—Ä–µ–Ω–æ—Å–∞ –º–µ–∂–¥—É —ç–∫–∑–µ–º–ø–ª—è—Ä–∞–º–∏.</small>
</div>
</div>
</div>
<div class="rules-layout" style="display: flex; gap: 1rem; min-height: 500px;">
<div class="rules-list-column" style="flex: 0 0 500px; border-right: 1px solid hsl(var(--border)); padding-right: 1rem;">
<div id="rulesList" class="rules-list" style="max-height: calc(100vh - 350px); overflow-y: auto;">
<p style="color: hsl(var(--muted-foreground)); text-align: center; padding: 40px 20px;">–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∞–≤–∏–ª...</p>
</div>
</div>
<div class="rules-details-column" style="flex: 1; padding-left: 1rem;">
<div id="ruleDetails" style="display: none;">
<div id="ruleDetailsView" style="display: none;">
<h3 style="margin-top: 0;">–î–µ—Ç–∞–ª–∏ –ø—Ä–∞–≤–∏–ª–∞</h3>
<div id="ruleDetailsContent"></div>
</div>
<div id="ruleFormContainer" style="display: none;">
<div id="addAlert" class="alert"></div>
<form id="ruleForm">
<div class="form-group">
<label for="ruleName">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞</label>
<input type="text" id="ruleName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç" required>
<small class="form-hint">–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</small>
</div>
<div class="form-group">
<label for="condition">–£—Å–ª–æ–≤–∏–µ (JavaScript –≤—ã—Ä–∞–∂–µ–Ω–∏–µ)</label>
<div class="condition-builder">
<div class="condition-mode-toggle">
<label>
<input type="radio" name="conditionMode" value="visual" checked>
–í–∏–∑—É–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º
</label>
<label>
<input type="radio" name="conditionMode" value="code">
–†—É—á–Ω–æ–π –≤–≤–æ–¥ (JavaScript)
</label>
</div>
<div class="visual-condition-editor" id="visualConditionEditor">
<div class="condition-groups">
<div class="condition-group">
<div class="condition-rows">
<div class="condition-row">
<select class="field-select">
<option value="payload.team_id">ID –∫–æ–º–∞–Ω–¥—ã</option>
<option value="payload.team.name">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã</option>
<option value="payload.status">–°—Ç–∞—Ç—É—Å</option>
<option value="payload.category" selected>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</option>
<option value="payload.impact">–í–ª–∏—è–Ω–∏–µ</option>
<option value="payload.priority">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
<option value="payload.requested_by.name">–ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä</option>
</select>
<select class="operator-select">
<option value="===" selected>—Ä–∞–≤–Ω–æ</option>
<option value="!==">–Ω–µ —Ä–∞–≤–Ω–æ</option>
<option value=">">–±–æ–ª—å—à–µ</option>
<option value="<">–º–µ–Ω—å—à–µ</option>
<option value="includes">—Å–æ–¥–µ—Ä–∂–∏—Ç</option>
</select>
<input type="text" class="value-input" placeholder="–ó–Ω–∞—á–µ–Ω–∏–µ" value="incident">
</div>
</div>
<button class="add-condition-btn">
<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<line x1="12" y1="5" x2="12" y2="19"></line>
<line x1="5" y1="12" x2="19" y2="12"></line>
</svg>
–î–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–∏–µ
</button>
</div>
</div>
<div class="condition-logic">
<label>
<input type="radio" name="groupLogic" value="AND" checked>
–ò (AND) - –≤—Å–µ —É—Å–ª–æ–≤–∏—è –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è
</label>
<label>
<input type="radio" name="groupLogic" value="OR">
–ò–õ–ò (OR) - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ —É—Å–ª–æ–≤–∏—è
</label>
</div>
</div>
<div class="code-condition-editor" id="codeConditionEditor" style="display: none;">
<textarea id="conditionCode" placeholder='–ù–∞–ø—Ä–∏–º–µ—Ä: payload.category === "incident" && payload.impact === "high"'>payload.category === "incident"</textarea>
<small class="form-hint">–î–æ—Å—Ç—É–ø–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è <code>payload</code> —Å –¥–∞–Ω–Ω—ã–º–∏ –≤–µ–±—Ö—É–∫–∞</small>
</div>
<div class="preview-section">
<h3>üëÄ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —É—Å–ª–æ–≤–∏—è</h3>
<div class="preview-result">
<strong>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥:</strong>
<pre id="conditionPreview">payload.category === "incident"</pre>
</div>
<input type="hidden" id="condition" value='payload.category === "incident"'>
<h3>üì± –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–æ–æ–±—â–µ–Ω–∏—è</h3>
<div class="telegram-preview">
<div class="telegram-message">
<div class="telegram-avatar">ü§ñ</div>
<div class="telegram-content">
<div class="telegram-sender">Webhook Bot</div>
<div class="telegram-text" id="messagePreview">
üÜî ID: 141<br><br>
üìã –¢–µ–º–∞: –ù–æ—É—Ç–±—É–∫ CMP00035 –±–æ–ª—å—à–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è<br><br>
üë§ –ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞: –ú–æ–∫–æ—Å–µ–µ–≤–∞ –ö—Å–µ–Ω–∏—è @–ê–û –ü—Ä–æ–ü—Ä–æ–¥—É–∫—Ç<br><br>
–ö–æ–º–∞–Ω–¥–∞: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π<br>
–ö–∞—Ç–µ–≥–æ—Ä–∏—è: incident<br>
–í–ª–∏—è–Ω–∏–µ: medium<br><br>
üìù –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:<br>
1. –ê—Ñ–∞–Ω–∞—Å–µ–Ω–∫–æ –í–∞–ª–µ—Ä–∏–π @–ê–û –ü—Ä–æ–ü—Ä–æ–¥—É–∫—Ç (07.01.2026, 16:36): avwqrgw
</div>
<div class="telegram-time">–¢–æ–ª—å–∫–æ —á—Ç–æ</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="form-group">
<label for="chatId">ID Telegram —á–∞—Ç–∞</label>
<input type="text" id="chatId" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: -1001234567890" required>
<small class="form-hint">–î–ª—è –≥—Ä—É–ø–ø—ã/–∫–∞–Ω–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ. –ú–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ ID —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é.</small>
</div>
<div class="form-group">
<label for="botToken">–¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
<div class="input-with-button">
<input type="password" id="botToken" placeholder="123456789:ABCdefGHIjklMNOpqrsTUVwxyz" required>
<button type="button" class="toggle-password" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –ø–∞—Ä–æ–ª—å">üëÅÔ∏è</button>
</div>
<small class="form-hint">–ü–æ–ª—É—á–∏—Ç–µ –æ—Ç @BotFather –≤ Telegram. –ö–∞–∂–¥–æ–µ –ø—Ä–∞–≤–∏–ª–æ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞.</small>
</div>
<div class="form-group">
<label for="messageTemplate">–®–∞–±–ª–æ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
<textarea id="messageTemplate" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç–æ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ–ª–Ω–æ–≥–æ payload"></textarea>
<small class="form-hint">–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ <code>${'{payload}'}</code> –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —à–∞–±–ª–æ–Ω.</small>
</div>
<div class="form-group checkbox-group">
<input type="checkbox" id="enabled" checked>
<label for="enabled" style="margin: 0;">–í–∫–ª—é—á–µ–Ω–æ</label>
</div>
<div class="button-group">
<button type="submit" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ</button>
<button type="reset" class="btn-secondary">–û—á–∏—Å—Ç–∏—Ç—å</button>
</div>
</form>
</div>
</div>
<div id="ruleDetailsPlaceholder" style="color: hsl(var(--muted-foreground)); text-align: center; padding: 2rem;">
<p style="margin-bottom: 1rem;">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–∞–≤–∏–ª–æ –∏–∑ —Å–ø–∏—Å–∫–∞ —Å–ª–µ–≤–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</p>
<button class="btn-primary" onclick="createNewRule()" style="display: inline-flex; align-items: center; gap: 0.5rem;">
<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<line x1="12" y1="5" x2="12" y2="19"></line>
<line x1="5" y1="12" x2="19" y2="12"></line>
</svg>
–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ
</button>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="test-tab" class="tab-pane">
<div class="content">
<div class="card">
<h2>üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ª–æ–≤–∏–π</h2>
<div class="form-group">
<label for="testCondition">–£—Å–ª–æ–≤–∏–µ</label>
<input type="text" id="testCondition" placeholder='payload.team_id === 40' value='payload.category === "incident"'>
</div>
<div class="form-group">
<label for="testPayload">–¢–µ—Å—Ç–æ–≤—ã–π payload (JSON)</label>
<textarea id="testPayload" placeholder='{"team_id": 40, "name": "Test"}'>{
"team_id": 40,
"team": {
"id": 40,
"name": "–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"
},
"category": "incident",
"impact": "medium",
"subject": "–ù–æ—É—Ç–±—É–∫ CMP00035 –±–æ–ª—å—à–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è",
"requested_by": {
"name": "–ú–æ–∫–æ—Å–µ–µ–≤–∞ –ö—Å–µ–Ω–∏—è",
"account": {
"name": "–ê–û –ü—Ä–æ–ü—Ä–æ–¥—É–∫—Ç"
}
},
"note": [
{
"text": "avwqrgw",
"person": {
"name": "–ê—Ñ–∞–Ω–∞—Å–µ–Ω–∫–æ –í–∞–ª–µ—Ä–∏–π"
},
"account": {
"name": "–ê–û –ü—Ä–æ–ü—Ä–æ–¥—É–∫—Ç"
},
"created_at": "2026-01-07T16:36:27Z"
}
],
"resolution_target_at": "2024-07-29T19:20:00Z",
"response_target_at": "2024-07-26T21:50:00Z"
}</textarea>
<small class="form-hint">–í—Å—Ç–∞–≤—å—Ç–µ –ø—Ä–∏–º–µ—Ä payload –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</small>
</div>
<button class="btn-test" onclick="testCondition()">–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Å–ª–æ–≤–∏–µ</button>
<div id="testResult" class="test-result"></div>
</div>
<div class="card">
<h2>üì§ –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram</h2>
<div class="form-group">
<label for="testBotToken">–¢–æ–∫–µ–Ω –±–æ—Ç–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</label>
<div class="input-with-button">
<input type="password" id="testBotToken" placeholder="123456789:ABCdefGHIjklMNOpqrsTUVwxyz">
<button type="button" class="toggle-password-test" aria-label="–ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å –ø–∞—Ä–æ–ª—å">üëÅÔ∏è</button>
</div>
<small class="form-hint">–¢–æ–∫–µ–Ω –±–æ—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è. –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∫–∞–∫ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø—Ä–∞–≤–∏–ª –±–µ–∑ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.</small>
<button class="btn-secondary btn-small" onclick="saveTestBotToken()" style="margin-top: 0.5rem;">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω</button>
</div>
<div class="form-group">
<label for="testChatId">ID —á–∞—Ç–∞</label>
<input type="text" id="testChatId" placeholder="-1001234567890">
<small class="form-hint">ID —á–∞—Ç–∞ –∏–ª–∏ –∫–∞–Ω–∞–ª–∞ –≤ Telegram</small>
</div>
<div class="form-group">
<label for="testMessage">–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</label>
<textarea id="testMessage" placeholder="–ü—Ä–∏–≤–µ—Ç –∏–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞!">–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ webhook –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏</textarea>
</div>
<button class="btn-primary" onclick="testTelegramSend()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</button>
<div id="telegramTestResult" class="test-result"></div>
</div>
</div>
</div>
<div id="history-tab" class="tab-pane">
<div class="card">
<div class="logs-toolbar">
<h2>üìä –ò—Å—Ç–æ—Ä–∏—è –≤–µ–±—Ö—É–∫–æ–≤</h2>
<div class="logs-actions">
<button class="btn-secondary" onclick="loadWebhookLogs()">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
<path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
</svg>
–û–±–Ω–æ–≤–∏—Ç—å
</button>
<button class="btn-danger" onclick="clearWebhookLogs()">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<polyline points="3 6 5 6 21 6"></polyline>
<path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
<line x1="10" y1="11" x2="10" y2="17"></line>
<line x1="14" y1="11" x2="14" y2="17"></line>
</svg>
–û—á–∏—Å—Ç–∏—Ç—å
</button>
</div>
</div>
<div id="logsAlert" class="alert"></div>
<div class="logs-layout" style="display: flex; gap: 1rem; min-height: 500px;">
<div class="logs-list" style="flex: 0 0 400px; border-right: 1px solid hsl(var(--border)); padding-right: 1rem;">
<div id="logsContainer" class="logs-container skeleton" style="max-height: calc(100vh - 300px); overflow-y: auto;">
<p style="color: hsl(var(--muted-foreground)); text-align: center;">–ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏...</p>
</div>
<div class="pagination" style="margin-top: 1rem;">
<button class="page-btn prev" disabled>‚Üê –ü—Ä–µ–¥</button>
<span class="page-info">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 –∏–∑ 1</span>
<button class="page-btn next" disabled>–°–ª–µ–¥ ‚Üí</button>
</div>
</div>
<div class="logs-details" style="flex: 1; padding-left: 1rem;">
<div id="logDetails" style="display: none;">
<h3 style="margin-top: 0;">–î–µ—Ç–∞–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</h3>
<div id="logDetailsContent"></div>
</div>
<div id="logDetailsPlaceholder" style="color: hsl(var(--muted-foreground)); text-align: center; padding: 2rem;">
–í—ã–±–µ—Ä–∏—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–∑ —Å–ø–∏—Å–∫–∞ —Å–ª–µ–≤–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π
</div>
</div>
</div>
</div>
</div>
<div id="queue-tab" class="tab-pane">
<div class="content">
<div class="card">
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
<h2>üì¨ –û—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π</h2>
<div style="display: flex; gap: 0.5rem;">
<select id="queueStatusFilter" style="padding: 0.5rem; border-radius: calc(var(--radius) - 2px); border: 1px solid hsl(var(--border)); background: hsl(var(--background));">
<option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
<option value="pending">–û–∂–∏–¥–∞–µ—Ç</option>
<option value="processing">–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è</option>
<option value="sent">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</option>
<option value="failed">–û—à–∏–±–∫–∞</option>
</select>
<button class="btn-primary" onclick="loadQueueHistory()">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
</div>
</div>
<div id="queueAlert" class="alert"></div>
<div id="queueStats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">
<div style="background: hsl(var(--card)); padding: 1rem; border-radius: calc(var(--radius) - 2px); border: 1px solid hsl(var(--border));">
<div style="font-size: 0.875rem; color: hsl(var(--muted-foreground)); margin-bottom: 0.25rem;">–í—Å–µ–≥–æ</div>
<div style="font-size: 1.5rem; font-weight: 600;" id="queueTotal">-</div>
</div>
<div style="background: hsl(var(--card)); padding: 1rem; border-radius: calc(var(--radius) - 2px); border: 1px solid hsl(var(--border));">
<div style="font-size: 0.875rem; color: hsl(var(--muted-foreground)); margin-bottom: 0.25rem;">–û–∂–∏–¥–∞–µ—Ç</div>
<div style="font-size: 1.5rem; font-weight: 600; color: #f59e0b;" id="queuePending">-</div>
</div>
<div style="background: hsl(var(--card)); padding: 1rem; border-radius: calc(var(--radius) - 2px); border: 1px solid hsl(var(--border));">
<div style="font-size: 0.875rem; color: hsl(var(--muted-foreground)); margin-bottom: 0.25rem;">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</div>
<div style="font-size: 1.5rem; font-weight: 600; color: #10b981;" id="queueSent">-</div>
</div>
<div style="background: hsl(var(--card)); padding: 1rem; border-radius: calc(var(--radius) - 2px); border: 1px solid hsl(var(--border));">
<div style="font-size: 0.875rem; color: hsl(var(--muted-foreground)); margin-bottom: 0.25rem;">–û—à–∏–±–∫–∞</div>
<div style="font-size: 1.5rem; font-weight: 600; color: #ef4444;" id="queueFailed">-</div>
</div>
</div>
<div id="queueTableContainer" style="overflow-x: auto;">
<table style="width: 100%; border-collapse: collapse;">
<thead>
<tr style="border-bottom: 2px solid hsl(var(--border)); text-align: left;">
<th style="padding: 0.75rem; font-weight: 600;">ID</th>
<th style="padding: 0.75rem; font-weight: 600;">–°—Ç–∞—Ç—É—Å</th>
<th style="padding: 0.75rem; font-weight: 600;">–ß–∞—Ç ID</th>
<th style="padding: 0.75rem; font-weight: 600;">–°–æ–æ–±—â–µ–Ω–∏–µ</th>
<th style="padding: 0.75rem; font-weight: 600;">–ü–æ–ø—ã—Ç–∫–∏</th>
<th style="padding: 0.75rem; font-weight: 600;">–°–æ–∑–¥–∞–Ω–æ</th>
<th style="padding: 0.75rem; font-weight: 600;">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</th>
<th style="padding: 0.75rem; font-weight: 600;">–û—à–∏–±–∫–∞</th>
</tr>
</thead>
<tbody id="queueTableBody">
<tr>
<td colspan="8" style="text-align: center; padding: 2rem; color: hsl(var(--muted-foreground));">
–ó–∞–≥—Ä—É–∑–∫–∞...
</td>
</tr>
</tbody>
</table>
</div>
<div id="queuePagination" style="display: flex; justify-content: center; align-items: center; gap: 1rem; margin-top: 1.5rem;">
</div>
</div>
</div>
</div>
<div id="users-tab" class="tab-pane">
<div class="content">
<div class="card" id="createUserCard" style="display: none;">
<div class="card-header">
<h2>üë§ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
</div>
<div class="card-content">
<div id="createUserAlert" class="alert"></div>
<form id="createUserForm">
<div class="form-group">
<label for="newUsername">–õ–æ–≥–∏–Ω</label>
<input type="text" id="newUsername" placeholder="username" required>
</div>
<div class="form-group">
<label for="newPassword">–ü–∞—Ä–æ–ª—å</label>
<input type="password" id="newPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required>
</div>
<div class="button-group">
<button type="submit" class="btn-primary">–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
<button type="button" class="btn-secondary" onclick="cancelCreateUser()">–û—Ç–º–µ–Ω–∞</button>
</div>
</form>
</div>
</div>
<div class="card">
<div class="rules-toolbar">
<h2>üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h2>
<button class="btn-primary btn-small" id="createUserBtn" onclick="showCreateUserForm()" style="display: none;">
<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
<line x1="12" y1="5" x2="12" y2="19"></line>
<line x1="5" y1="12" x2="19" y2="12"></line>
</svg>
–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
</button>
</div>
<div id="usersAlert" class="alert"></div>
<div id="usersList" class="rules-list">
<p style="color: #999; text-align: center; padding: 40px 20px;">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<script>
const API_BASE = '/api';
let editingRuleId = null;
let isEditingRuleLoading = false;
let authToken = localStorage.getItem('authToken');
let currentPage = 1;
const logsPerPage = 10;
let currentUser = null; // ‚Üê –î–û–ë–ê–í–õ–ï–ù–û: —Ö—Ä–∞–Ω–∏–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

// Initialize on page load
document.addEventListener('DOMContentLoaded', () => {
checkAuthStatus();
setupEventListeners();
loadSavedTheme();
updateWebhookUrl();
});

function setupEventListeners() {
document.getElementById('loginForm').addEventListener('submit', handleLogin);
document.getElementById('ruleForm').addEventListener('submit', saveRule);
document.querySelectorAll('.tab').forEach(tab => {
tab.addEventListener('click', () => {
document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
document.querySelectorAll('.tab-pane').forEach(t => t.classList.remove('active'));
tab.classList.add('active');
document.getElementById(`${tab.dataset.tab}-tab`).classList.add('active');
if (tab.dataset.tab === 'users') {
loadUsers();
} else if (tab.dataset.tab === 'history') {
loadWebhookLogs();
} else if (tab.dataset.tab === 'queue') {
loadQueueHistory();
loadQueueStats();
}
});
});
document.getElementById('themeToggle').addEventListener('click', toggleTheme);
document.querySelectorAll('input[name="conditionMode"]').forEach(radio => {
radio.addEventListener('change', function() {
document.getElementById('visualConditionEditor').style.display = this.value === 'visual' ? 'block' : 'none';
document.getElementById('codeConditionEditor').style.display = this.value === 'code' ? 'block' : 'none';
if (this.value === 'visual') {
updateConditionPreview();
}
});
});
document.querySelector('.field-select').addEventListener('change', updateConditionPreview);
document.querySelector('.operator-select').addEventListener('change', updateConditionPreview);
document.querySelector('.value-input').addEventListener('input', updateConditionPreview);
document.querySelector('.add-condition-btn').addEventListener('click', addConditionRow);
document.getElementById('conditionCode').addEventListener('input', updateCodeCondition);
document.querySelector('.toggle-password').addEventListener('click', function() {
togglePasswordVisibility('#botToken', this);
});
document.querySelector('.toggle-password-test').addEventListener('click', function() {
togglePasswordVisibility('#testBotToken', this);
});
document.getElementById('rulesSearch').addEventListener('input', function() {
filterRules(this.value);
});
const queueStatusFilter = document.getElementById('queueStatusFilter');
if (queueStatusFilter) {
queueStatusFilter.addEventListener('change', function() {
loadQueueHistory(1);
});
}
document.getElementById('webhookUrl').addEventListener('click', copyWebhookUrl);
document.getElementById('importFile').addEventListener('change', importRules);
}

function loadSavedTheme() {
const savedTheme = localStorage.getItem('theme');
if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
document.documentElement.classList.add('dark-theme');
}
}

function toggleTheme() {
document.documentElement.classList.toggle('dark-theme');
localStorage.setItem('theme', document.documentElement.classList.contains('dark-theme') ? 'dark' : 'light');
}

function togglePasswordVisibility(inputSelector, button) {
const input = document.querySelector(inputSelector);
if (input.type === 'password') {
input.type = 'text';
button.textContent = 'üôà';
} else {
input.type = 'password';
button.textContent = 'üëÅÔ∏è';
}
}

function addConditionRow() {
const newRow = document.createElement('div');
newRow.className = 'condition-row';
newRow.innerHTML = `
<select class="field-select">
<option value="payload.team_id">ID –∫–æ–º–∞–Ω–¥—ã</option>
<option value="payload.team.name">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã</option>
<option value="payload.status">–°—Ç–∞—Ç—É—Å</option>
<option value="payload.category">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</option>
<option value="payload.impact">–í–ª–∏—è–Ω–∏–µ</option>
<option value="payload.priority">–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</option>
<option value="payload.requested_by.name">–ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä</option>
</select>
<select class="operator-select">
<option value="===">—Ä–∞–≤–Ω–æ</option>
<option value="!==">–Ω–µ —Ä–∞–≤–Ω–æ</option>
<option value=">">–±–æ–ª—å—à–µ</option>
<option value="<">–º–µ–Ω—å—à–µ</option>
<option value="includes">—Å–æ–¥–µ—Ä–∂–∏—Ç</option>
</select>
<input type="text" class="value-input" placeholder="–ó–Ω–∞—á–µ–Ω–∏–µ">
<button type="button" class="remove-condition-btn">-</button>
`;
document.querySelector('.condition-rows').appendChild(newRow);
newRow.querySelector('.field-select').addEventListener('change', updateConditionPreview);
newRow.querySelector('.operator-select').addEventListener('change', updateConditionPreview);
newRow.querySelector('.value-input').addEventListener('input', updateConditionPreview);
newRow.querySelector('.remove-condition-btn').addEventListener('click', function() {
newRow.remove();
updateConditionPreview();
});
updateConditionPreview();
}

function updateConditionPreview() {
const field = document.querySelector('.field-select').value;
const operator = document.querySelector('.operator-select').value;
const value = document.querySelector('.value-input').value;
let needsQuotes = true;
let formattedValue = value;
if (field.includes('.id') || field.includes('_id') ||
field.includes('.priority') ||
(field === 'payload.priority' && !isNaN(value)) ||
(field === 'payload.team_id' && !isNaN(value))) {
needsQuotes = false;
}
if (operator === '>' || operator === '<' || operator === '>=' || operator === '<=') {
needsQuotes = false;
}
if (needsQuotes) {
if (value.toLowerCase() === 'true' || value.toLowerCase() === 'false') {
formattedValue = value.toLowerCase();
} else {
formattedValue = `"${value.replace(/"/g, '\\"')}"`;
}
} else {
formattedValue = value.replace(/['"]/g, '');
}
const condition = `${field} ${operator} ${formattedValue}`;
document.getElementById('conditionPreview').textContent = condition;
document.getElementById('condition').value = condition;
document.getElementById('testCondition').value = condition;
updateMessagePreview(condition);
}

function updateCodeCondition() {
const condition = document.getElementById('conditionCode').value;
document.getElementById('condition').value = condition;
document.getElementById('conditionPreview').textContent = condition;
updateMessagePreview(condition);
}

function updateMessagePreview(condition) {
const payload = {
id: 141,
team_id: 40,
team: {
id: 40,
name: '–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π'
},
category: 'incident',
impact: 'medium',
subject: '–ù–æ—É—Ç–±—É–∫ CMP00035 –±–æ–ª—å—à–µ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è',
requested_by: {
name: '–ú–æ–∫–æ—Å–µ–µ–≤–∞ –ö—Å–µ–Ω–∏—è',
account: {
name: '–ê–û –ü—Ä–æ–ü—Ä–æ–¥—É–∫—Ç'
}
},
note: [{
text: 'avwqrgw',
person: {
name: '–ê—Ñ–∞–Ω–∞—Å–µ–Ω–∫–æ –í–∞–ª–µ—Ä–∏–π'
},
account: {
name: '–ê–û –ü—Ä–æ–ü—Ä–æ–¥—É–∫—Ç'
},
created_at: '2026-01-07T16:36:27Z'
}],
resolution_target_at: '2024-07-29T19:20:00Z',
response_target_at: '2024-07-26T21:50:00Z'
};
let message = '';
if (payload.id) {
message += `üÜî ID: ${payload.id}\n`;
}
if (payload.subject) {
message += `üìã –¢–µ–º–∞: ${payload.subject}\n`;
}
if (payload.requested_by?.name) {
const account = payload.requested_by.account?.name || '';
message += `üë§ –ò–Ω–∏—Ü–∏–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞: ${payload.requested_by.name}${account ? ' @' + account : ''}\n`;
}
if (payload.team?.name) {
message += `–ö–æ–º–∞–Ω–¥–∞: ${payload.team.name}\n`;
}
if (payload.category) {
message += `–ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${payload.category}\n`;
}
if (payload.impact) {
message += `–í–ª–∏—è–Ω–∏–µ: ${payload.impact}\n`;
}
message += '\n';
if (payload.response_target_at || payload.resolution_target_at) {
if (payload.response_target_at) {
try {
const date = new Date(payload.response_target_at);
if (!isNaN(date.getTime())) {
message += `‚è∞ –ö—Ä–∞–π–Ω–∏–π —Å—Ä–æ–∫ –æ—Ç–≤–µ—Ç–∞: ${date.toLocaleString('ru-RU', {
day: '2-digit',
month: '2-digit',
year: 'numeric',
hour: '2-digit',
minute: '2-digit'
})}\n`;
}
} catch (e) {
message += `‚è∞ –ö—Ä–∞–π–Ω–∏–π —Å—Ä–æ–∫ –æ—Ç–≤–µ—Ç–∞: ${payload.response_target_at}\n`;
}
}
if (payload.resolution_target_at) {
try {
const date = new Date(payload.resolution_target_at);
if (!isNaN(date.getTime())) {
message += `‚è∞ –ö—Ä–∞–π–Ω–∏–π —Å—Ä–æ–∫ —Ä–µ—à–µ–Ω–∏—è: ${date.toLocaleString('ru-RU', {
day: '2-digit',
month: '2-digit',
year: 'numeric',
hour: '2-digit',
minute: '2-digit'
})}\n`;
}
} catch (e) {
message += `‚è∞ –ö—Ä–∞–π–Ω–∏–π —Å—Ä–æ–∫ —Ä–µ—à–µ–Ω–∏—è: ${payload.resolution_target_at}\n`;
}
}
message += '\n';
}
if (payload.note) {
message += `üìù –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:\n`;
const notes = Array.isArray(payload.note) ? payload.note : [payload.note];
notes.forEach((note, index) => {
const author = note.person?.name || note.person_name || 'Unknown';
const account = note.account?.name || note.person?.account?.name || '';
const text = note.text || '';
let timestamp = '';
if (note.created_at) {
try {
const date = new Date(note.created_at);
if (!isNaN(date.getTime())) {
timestamp = date.toLocaleString('ru-RU', {
day: '2-digit',
month: '2-digit',
year: 'numeric',
hour: '2-digit',
minute: '2-digit'
});
} else {
timestamp = note.created_at;
}
} catch (e) {
timestamp = note.created_at;
}
}
message += `${index + 1}. ${author}${account ? ' @' + account : ''}${timestamp ? ' (' + timestamp + ')' : ''}: ${text}\n`;
});
}
document.getElementById('messagePreview').innerHTML = message.replace(/\n/g, '<br>');
}

async function checkAuthStatus() {
try {
const response = await fetch(`${API_BASE}/auth-status`, {
headers: authToken ? { 'Authorization': `Bearer ${authToken}` } : {}
});
const data = await response.json();
if (data.authenticated) {
// –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –î–û –ø–æ–∫–∞–∑–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
const meResponse = await fetch(`${API_BASE}/me`, { headers: { 'Authorization': `Bearer ${authToken}` } });
if (meResponse.ok) {
currentUser = await meResponse.json();
}
showMainApp();
} else {
showLoginScreen();
}
} catch (error) {
showLoginScreen();
}
}

async function handleLogin(e) {
e.preventDefault();
const username = document.getElementById('username').value;
const password = document.getElementById('password').value;
try {
const response = await fetch(`${API_BASE}/login`, {
method: 'POST',
headers: { 'Content-Type': 'application/json' },
body: JSON.stringify({ username, password })
});
if (response.ok) {
const data = await response.json();
authToken = data.token;
localStorage.setItem('authToken', authToken);
// –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const meResponse = await fetch(`${API_BASE}/me`, { headers: { 'Authorization': `Bearer ${authToken}` } });
if (meResponse.ok) {
currentUser = await meResponse.json();
} else {
currentUser = { username, userId: null };
}
showMainApp();
} else {
showLoginAlert('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å', 'error');
document.getElementById('password').value = '';
}
} catch (error) {
showLoginAlert('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ' + error.message, 'error');
}
}

function showLoginScreen() {
document.getElementById('loginContainer').classList.remove('hidden');
document.getElementById('mainApp').style.display = 'none';
}

async function showMainApp() {
document.getElementById('loginContainer').classList.add('hidden');
document.getElementById('mainApp').style.display = 'block';
const usernameEl = document.getElementById('currentUsername');
if (usernameEl && currentUser) {
usernameEl.textContent = `üë§ ${currentUser.username}`;
}
const usersTab = document.getElementById('usersTab');
const createUserBtn = document.getElementById('createUserBtn');
if (usersTab && createUserBtn && currentUser && currentUser.username === 'vadmin') {
usersTab.style.display = 'flex';
createUserBtn.style.display = 'flex';
loadUsers();
} else {
if (usersTab) usersTab.style.display = 'none';
if (createUserBtn) createUserBtn.style.display = 'none';
}
loadRules();
loadWebhookLogs();
}

function showLoginAlert(message, type) {
const alert = document.getElementById('loginAlert');
alert.textContent = message;
alert.className = `login-alert show alert-${type}`;
}

async function logout() {
try {
await fetch(`${API_BASE}/logout`, {
method: 'POST',
headers: { 'Authorization': `Bearer ${authToken}` }
});
localStorage.removeItem('authToken');
authToken = null;
currentUser = null;
showLoginScreen();
document.getElementById('loginForm').reset();
} catch (error) {
console.error('Logout error:', error);
}
}

function getHeaders() {
return {
'Content-Type': 'application/json',
'Authorization': `Bearer ${authToken}`
};
}

function updateWebhookUrl() {
const url = `${window.location.origin}/webhook`;
const webhookUrlElement = document.getElementById('webhookUrl');
const webhookUrlSettingsElement = document.getElementById('webhookUrlSettings');
if (webhookUrlElement) {
webhookUrlElement.textContent = url;
}
if (webhookUrlSettingsElement) {
webhookUrlSettingsElement.textContent = url;
}
}

// ‚úÖ –û–°–ù–û–í–ù–û–ï –ò–ó–ú–ï–ù–ï–ù–ò–ï: –¥–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä currentUser
async function loadRules() {
const detailsPanel = document.getElementById('ruleDetails');
const placeholder = document.getElementById('ruleDetailsPlaceholder');
const detailsView = document.getElementById('ruleDetailsView');
const formContainer = document.getElementById('ruleFormContainer');
if (detailsPanel && placeholder) {
detailsPanel.style.display = 'none';
placeholder.style.display = 'block';
}
if (detailsView) detailsView.style.display = 'none';
if (formContainer) formContainer.style.display = 'none';
try {
const response = await fetch(`${API_BASE}/rules`, { headers: getHeaders() });
if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
const rules = await response.json();
if (!Array.isArray(rules)) throw new Error('Invalid response format from server');
// ‚úÖ –ü–ï–†–ï–î–ê–Å–ú currentUser –≤ displayRules
displayRules(rules, currentUser);
} catch (error) {
console.error('Error loading rules:', error);
showAlert('rulesAlert', '–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∞–≤–∏–ª: ' + error.message, 'error');
const container = document.getElementById('rulesList');
if (container) {
container.innerHTML = '<p style="color: hsl(var(--destructive)); text-align: center; padding: 40px 20px;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∞–≤–∏–ª: ' + escapeHtml(error.message) + '</p>';
}
}
}

// ‚úÖ –ò–ó–ú–ï–ù–ï–ù–ê –§–£–ù–ö–¶–ò–Ø: –ø—Ä–∏–Ω–∏–º–∞–µ—Ç currentUser
function displayRules(rules, currentUser) {
const container = document.getElementById('rulesList');
const searchQuery = document.getElementById('rulesSearch').value.toLowerCase();
const filteredRules = rules.filter(rule =>
rule.name.toLowerCase().includes(searchQuery) ||
rule.condition.toLowerCase().includes(searchQuery) ||
rule.chatId.toString().includes(searchQuery)
);
if (filteredRules.length === 0) {
container.innerHTML = '<p style="color: hsl(var(--muted-foreground)); text-align: center; padding: 40px 20px;">–ü—Ä–∞–≤–∏–ª–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
return;
}

// ‚úÖ –§–£–ù–ö–¶–ò–Ø –ü–†–û–í–ï–†–ö–ò –ü–†–ê–í
function canModifyRule(rule, user) {
if (!user) return false;
if (user.username === 'vadmin') return true;
if (typeof rule.authorId === 'number' && rule.authorId === user.userId) return true;
return false;
}

container.innerHTML = `
<table style="width: 100%; border-collapse: collapse;">
<thead>
<tr style="border-bottom: 2px solid hsl(var(--border)); text-align: left;">
<th style="padding: 0.5rem; font-weight: 600;">–°—Ç–∞—Ç—É—Å</th>
<th style="padding: 0.5rem; font-weight: 600;">–ù–∞–∑–≤–∞–Ω–∏–µ</th>
<th style="padding: 0.5rem; font-weight: 600;">–£—Å–ª–æ–≤–∏–µ</th>
<th style="padding: 0.5rem; font-weight: 600;">–ö–∞–Ω–∞–ª</th>
${currentUser ? '<th style="padding: 0.5rem; font-weight: 600;">–î–µ–π—Å—Ç–≤–∏—è</th>' : ''}
</tr>
</thead>
<tbody>
${filteredRules.map(rule => {
const hasAccess = canModifyRule(rule, currentUser);
const actionsHtml = hasAccess ? 
`<button class="btn-primary btn-small" onclick="event.stopPropagation(); editRule(${rule.id})">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
<button class="btn-danger btn-small" onclick="event.stopPropagation(); deleteRule(${rule.id})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>` : 
'<span style="color: hsl(var(--muted-foreground));">‚Äî</span>';

return `
<tr class="rule-row" data-rule-id="${rule.id}" style="border-bottom: 1px solid hsl(var(--border)); cursor: pointer; transition: background 0.2s;"
onmouseover="this.style.background='hsl(var(--accent))'"
onmouseout="this.style.background='transparent'"
onclick="loadRuleDetails(${rule.id})">
<td style="padding: 0.75rem 0.5rem;">
<span class="${rule.enabled ? 'log-success' : 'log-error'}" style="padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.875rem;">
${rule.enabled ? '‚úÖ –í–∫–ª' : '‚è∏Ô∏è –í—ã–∫–ª'}
</span>
</td>
<td style="padding: 0.75rem 0.5rem; font-weight: 500;">${escapeHtml(rule.name)}</td>
<td style="padding: 0.75rem 0.5rem;"><code style="font-size: 0.875rem; max-width: 200px; display: inline-block; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">${escapeHtml(rule.condition)}</code></td>
<td style="padding: 0.75rem 0.5rem;"><code>${escapeHtml(rule.chatId)}</code></td>
${currentUser ? `<td style="padding: 0.75rem 0.5rem;">${actionsHtml}</td>` : ''}
</tr>
`;
}).join('')}
</tbody>
</table>
`;
}

function updateRuleCard(updatedRule) {
const container = document.getElementById('rulesList');
const ruleRow = container.querySelector(`tr[data-rule-id="${updatedRule.id}"]`);
const searchQuery = document.getElementById('rulesSearch').value.toLowerCase();
const matchesFilter =
updatedRule.name.toLowerCase().includes(searchQuery) ||
updatedRule.condition.toLowerCase().includes(searchQuery) ||
updatedRule.chatId.toString().includes(searchQuery);
if (!ruleRow) {
loadRules();
return;
}
if (matchesFilter) {
// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ ‚Äî –Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫
loadRules(); // ‚Üê –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º
} else {
ruleRow.remove();
const tbody = container.querySelector('tbody');
if (tbody && tbody.children.length === 0) {
container.innerHTML = '<p style="color: hsl(var(--muted-foreground)); text-align: center; padding: 40px 20px;">–ü—Ä–∞–≤–∏–ª–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
}
}
}

// –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –±—ç–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –Ω–æ –∫–Ω–æ–ø–∫–∏ —É–∂–µ —Å–∫—Ä—ã—Ç—ã)
async function loadRuleDetails(ruleId) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function createNewRule() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function filterRules(query) {
loadRules();
}
async function saveRule(e) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
async function editRule(id) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
async function deleteRule(id) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
async function testCondition() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
async function testTelegramSend() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
async function loadWebhookLogs(page = 1) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function displayWebhookLogs(logs, page) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function updatePagination(currentPage, totalPages) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
async function loadLogDetails(logId) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
let currentQueuePage = 1;
let queueStatusFilter = '';
async function loadQueueHistory(page = 1) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function displayQueueHistory(messages, pagination) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function getStatusBadge(status) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function updateQueuePagination(pagination) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
async function loadQueueStats() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
async function clearWebhookLogs() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
async function saveTestBotToken() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
async function exportRules() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function importRules(e) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function toggleSettingsPanel() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function copyWebhookUrlFromSettings() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function copyWebhookUrl() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function showAlert(elementId, message, type) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function escapeHtml(text) {
if (typeof text !== 'string') return text;
return text.replace(/[&<>"']/g, m =>
({ '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#039;' }[m])
);
}

// User management functions
let currentUserId = null;
async function loadUsers() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function showCreateUserForm() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function cancelCreateUser() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
document.getElementById('createUserForm').addEventListener('submit', async (e) => {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
});
async function deleteUser(userId) {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}

// Change password functions
function showChangePasswordModal() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
function closeChangePasswordModal() {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
document.getElementById('changePasswordForm').addEventListener('submit', async (e) => {
// ... –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
});
</script>
</body>
</html>